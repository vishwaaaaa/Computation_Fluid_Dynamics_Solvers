function [U_elem1,U_elem2,U_elem3,U_elem4] = Basis_nn(p,s,U_basis)
% s- no. of elements it has been split into
n_split = sum(s);
rank = (p+1)*(p+2)/2;
xy1 = zeros(rank,2);
xy2 = zeros(rank,2);
xy3 = zeros(rank,2);
xy4 = zeros(rank,2);
nsv = width(U_basis);

%yolo = zeros(n_split,rank); % since number of elements you subdivide it in gives that many number of new nodes
yolo1 = zeros(rank,rank);
yolo2 = zeros(rank,rank);
yolo3 = zeros(rank,rank);
yolo4 = zeros(rank,rank);

U_elem1 = zeros(rank,nsv);
U_elem2 = zeros(rank,nsv);
U_elem3 = zeros(rank,nsv);
U_elem4 = zeros(rank,nsv);

switch n_split
    case 1
        switch p
            case 0
                for i=1:rank
                    yolo1(:,i)=1;
                    yolo2(:,i)=1;
                    yolo3(:,i)=0;
                    yolo4(:,i)=0;
                end
            case 1
                if s(1)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1; xy1(2,2) = 0;
                    xy1(3,1)=0.5; xy1(3,2) = 0.5;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 0;
                    xy2(2,1)=0.5; xy2(2,2) = 0.5;
                    xy2(3,1)=0; xy2(3,2) = 1;
                elseif s(2)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1; xy1(2,2) = 0;
                    xy1(3,1)=0; xy1(3,2) = 0.5;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 0.5;
                    xy2(2,1)=1; xy2(2,2) = 0;
                    xy2(3,1)=0; xy2(3,2) = 1;
                elseif s(3)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=0.5; xy1(2,2) = 0;
                    xy1(3,1)=0; xy1(3,2) = 1;
                    % Elem 2
                    xy2(1,1)=0.5; xy2(1,2) = 0;
                    xy2(2,1)=1; xy2(2,2) = 0;
                    xy2(3,1)=0; xy2(3,2) = 1;
                end
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=0;
                    yolo4(:,i)=0;
                end
           case 2
                if s(1)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=0.5; xy1(2,2) = 0;
                    xy1(3,1)=1; xy1(3,2) = 0;
                    xy1(4,1)=0.25; xy1(4,2) = 0.25;
                    xy1(5,1)=0.75; xy1(5,2) = 0.25;
                    xy1(6,1)=0.5; xy1(6,2) = 0.5;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 0;
                    xy2(2,1)=0.25; xy2(2,2) = 0.25;
                    xy2(3,1)=0.5; xy2(3,2) = 0.5;
                    xy2(4,1)=0; xy2(4,2) = 0.5;
                    xy2(5,1)=0.25; xy2(6,2) = 0.75;
                    xy2(6,1)=0; xy2(6,2) = 1;
                elseif s(2)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=0.5; xy1(2,2) = 0;
                    xy1(3,1)=1; xy1(3,2) = 0;
                    xy1(4,1)=0; xy1(4,2) = 0.25;
                    xy1(5,1)=0.5; xy1(5,2) = 0.25;
                    xy1(6,1)=0; xy1(6,2) = 0.5;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 0.5;
                    xy2(2,1)=0.5; xy2(2,2) = 0.25;
                    xy2(3,1)=1; xy2(3,2) = 0;
                    xy2(4,1)=0; xy2(4,2) = 0.75;
                    xy2(5,1)=0.5; xy2(6,2) = 0.5;
                    xy2(6,1)=0; xy2(6,2) = 1;
                elseif s(3)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=0.5; xy1(2,2) = 0;
                    xy1(3,1)=1; xy1(3,2) = 0;
                    xy1(4,1)=0; xy1(4,2) = 0.25;
                    xy1(5,1)=0.5; xy1(5,2) = 0.25;
                    xy1(6,1)=0; xy1(6,2) = 0.5;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 0.5;
                    xy2(2,1)=0.5; xy2(2,2) = 0.25;
                    xy2(3,1)=1; xy2(3,2) = 0;
                    xy2(4,1)=0; xy2(4,2) = 0.75;
                    xy2(5,1)=0.5; xy2(6,2) = 0.5;
                    xy2(6,1)=0; xy2(6,2) = 1;
                end
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=0;
                    yolo4(:,i)=0;
                end
           case 3
                if s(1)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1/3; xy1(2,2) = 0;
                    xy1(3,1)=2/3; xy1(3,2) = 0;
                    xy1(4,1)=1; xy1(4,2) = 0;
                    xy1(5,1)=1/6; xy1(5,2) = 1/6;
                    xy1(6,1)=1/2; xy1(6,2) = 1/6;
                    xy1(7,1)=5/6; xy1(7,2) = 1/6;
                    xy1(8,1)=1/3; xy1(8,2) = 1/3;
                    xy1(9,1)=2/3; xy1(9,2) = 1/3;
                    xy1(10,1)=0.5; xy1(10,2) = 0.5;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 0;
                    xy2(2,1)=1/6; xy2(2,2) = 1/6;
                    xy2(3,1)=1/3; xy2(3,2) = 1/3;
                    xy2(4,1)=0.5; xy2(4,2) = 0.5;
                    xy2(5,1)=0; xy2(6,2) = 1/3;
                    xy2(6,1)=1/6; xy2(6,2) = 0.5;
                    xy2(7,1)=2/6; xy2(7,2) = 4/6;                                      
                    xy2(8,1)=0; xy2(8,2) = 2/3;
                    xy2(9,1)=1/6; xy2(9,2) = 5/6;
                    xy2(10,1)=0; xy2(10,2) = 1;
                elseif s(2)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1/3; xy1(2,2) = 0;
                    xy1(3,1)=2/3; xy1(3,2) = 0;
                    xy1(4,1)=1; xy1(4,2) = 0;
                    xy1(5,1)=0; xy1(5,2) = 1/6;
                    xy1(6,1)=1/3; xy1(6,2) = 1/6;
                    xy1(7,1)=2/3; xy1(7,2) = 1/6;
                    xy1(8,1)=0; xy1(8,2) = 1/3;
                    xy1(9,1)=1/3; xy1(9,2) = 1/3;
                    xy1(10,1)=0.5; xy1(10,2) = 0.5;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 1/2;
                    xy2(2,1)=1/3; xy2(2,2) = 1/3;
                    xy2(3,1)=2/3; xy2(3,2) = 1/6;
                    xy2(4,1)=1; xy2(4,2) = 0;
                    xy2(5,1)=0; xy2(5,2) = 2/3;
                    xy2(6,1)=1/3; xy2(6,2) = 0.5;
                    xy2(7,1)=2/3; xy2(7,2) = 1/3;                                      
                    xy2(8,1)=0; xy2(8,2) = 5/6;
                    xy2(9,1)=1/3; xy2(9,2) = 2/3;
                    xy2(10,1)=0; xy2(10,2) = 1;
                elseif s(3)==1
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1/6; xy1(2,2) = 0;
                    xy1(3,1)=2/6; xy1(3,2) = 0;
                    xy1(4,1)=1/2; xy1(4,2) = 0;
                    xy1(5,1)=0; xy1(5,2) = 1/3;
                    xy1(6,1)=1/6; xy1(6,2) = 1/3;
                    xy1(7,1)=1/3; xy1(7,2) = 1/3;
                    xy1(8,1)=0; xy1(8,2) = 2/3;
                    xy1(9,1)=1/6; xy1(9,2) = 2/3;
                    xy1(10,1)=0; xy1(10,2) = 1;
                    % Elem 2
                    xy2(1,1)=1/2; xy2(1,2) = 0;
                    xy2(2,1)=2/3; xy2(2,2) = 0;
                    xy2(3,1)=5/6; xy2(3,2) = 0;
                    xy2(4,1)=1; xy2(4,2) = 0;
                    xy2(5,1)=1/3; xy2(5,2) = 1/3;
                    xy2(6,1)=1/2; xy2(6,2) = 1/3;
                    xy2(7,1)=2/3; xy2(7,2) = 1/3;                                      
                    xy2(8,1)=1/6; xy2(8,2) = 2/3;
                    xy2(9,1)=1/3; xy2(9,2) = 2/3;
                    xy2(10,1)=0; xy2(10,2) = 1;
                end
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=0;
                    yolo4(:,i)=0;
                end
        end
        %{
        for i=1:n_split
            yolo(:,i)=Basis(xy(i,:),p);
        end
        %}
    
    case 2
        switch p
            case 0
                for i=1:rank
                    yolo1(:,i)=1;
                    yolo2(:,i)=1;
                    yolo3(:,i)=1;
                    yolo4(:,i)=0;
                end
            case 1
                if s(1)==0
                    % Elem 1
                    xy1(1,1)=0;   xy1(1,2) = 0;
                    xy1(2,1)=1/2; xy1(2,2) = 0;
                    xy1(3,1)=0;   xy1(3,2) = 1/2;
                    % Elem 2
                    xy2(1,1)=1/2; xy2(1,2) = 0;
                    xy2(2,1)=1;   xy2(2,2) = 0;
                    xy2(3,1)=0;   xy2(3,2) = 1/2;
                    % Elem 3
                    xy3(1,1)=0; xy3(1,2) = 1/2;
                    xy3(2,1)=1; xy3(2,2) = 0;
                    xy3(3,1)=0; xy3(3,2) = 1;
                elseif s(2) ==0
                    % Elem 1
                    xy1(1,1)=0;   xy1(1,2) = 0;
                    xy1(2,1)=1/2; xy1(2,2) = 1/2;
                    xy1(3,1)=0;   xy1(3,2) = 1;
                    % Elem 2
                    xy2(1,1)=0;   xy2(1,2) = 0;
                    xy2(2,1)=1/2; xy2(2,2) = 0;
                    xy2(3,1)=1/2; xy2(3,2) = 1/2;
                    % Elem 3
                    xy3(1,1)=1/2; xy3(1,2) = 0;
                    xy3(2,1)=1; xy3(2,2) = 0;
                    xy3(3,1)=1/2; xy3(3,2) = 1/2;
                elseif s(3) ==0
                    % Elem 1
                    xy1(1,1)=0;   xy1(1,2) = 0;
                    xy1(2,1)=1/2; xy1(2,2) = 1/2;
                    xy1(3,1)=0;   xy1(3,2) = 1/2;
                    % Elem 2
                    xy2(1,1)=0;   xy2(1,2) = 0;
                    xy2(2,1)=1; xy2(2,2) = 0;
                    xy2(3,1)=1/2; xy2(3,2) = 1/2;
                    % Elem 3
                    xy3(1,1)=0; xy3(1,2) = 1/2;
                    xy3(2,1)=1/2; xy3(2,2) = 1/2;
                    xy3(3,1)=0; xy3(3,2) = 1;
                end
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=Basis(xy3(i,:),p);
                    yolo4(:,i)=0;
                end
            case 2
                if s(1)==0
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1/4; xy1(2,2) = 0;
                    xy1(3,1)=1/2; xy1(3,2) = 0;
                    xy1(4,1)=0; xy1(4,2) = 1/4;
                    xy1(5,1)=1/4; xy1(5,2) = 1/4;
                    xy1(6,1)=0; xy1(6,2) = 1/2;
                    % Elem 2
                    xy2(1,1)=1/2; xy2(1,2) = 0;
                    xy2(2,1)=3/4; xy2(2,2) = 0;
                    xy2(3,1)=1; xy2(3,2) = 0;
                    xy2(4,1)=1/4; xy2(4,2) = 1/4;
                    xy2(5,1)=3/4; xy2(6,2) = 1/4;
                    xy2(6,1)=0; xy2(6,2) = 1/2;
                    % Elem 3
                    xy3(1,1)=0; xy3(1,2) = 1/2;
                    xy3(2,1)=1/2; xy3(2,2) = 1/4;
                    xy3(3,1)=1; xy3(3,2) = 0;
                    xy3(4,1)=0; xy3(4,2) = 3/4;
                    xy3(5,1)=1/2; xy3(6,2) = 1/2;
                    xy3(6,1)=0; xy3(6,2) = 1;
                elseif s(2) ==0
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1/4; xy1(2,2) = 1/4;
                    xy1(3,1)=1/2; xy1(3,2) = 1/2;
                    xy1(4,1)=0; xy1(4,2) = 1/2;
                    xy1(5,1)=1/4; xy1(5,2) = 3/4;
                    xy1(6,1)=0; xy1(6,2) = 1;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 0;
                    xy2(2,1)=1/4; xy2(2,2) = 0;
                    xy2(3,1)=1/2; xy2(3,2) = 0;
                    xy2(4,1)=1/4; xy2(4,2) = 1/4;
                    xy2(5,1)=1/2; xy2(6,2) = 1/4;
                    xy2(6,1)=1/2; xy2(6,2) = 1/2;
                    % Elem 3
                    xy3(1,1)=1/2; xy3(1,2) = 0;
                    xy3(2,1)=3/4; xy3(2,2) = 0;
                    xy3(3,1)=1;   xy3(3,2) = 0;
                    xy3(4,1)=1/2; xy3(4,2) = 1/4;
                    xy3(5,1)=3/4; xy3(6,2) = 1/4;
                    xy3(6,1)=1/2; xy3(6,2) = 1/2;
                elseif s(3) ==0
                    % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1/4; xy1(2,2) = 1/4;
                    xy1(3,1)=1/2; xy1(3,2) = 1/2;
                    xy1(4,1)=0; xy1(4,2) = 1/4;
                    xy1(5,1)=1/4; xy1(5,2) = 1/2;
                    xy1(6,1)=0; xy1(6,2) = 1/2;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 0;
                    xy2(2,1)=1/2; xy2(2,2) = 0;
                    xy2(3,1)=1; xy2(3,2) = 0;
                    xy2(4,1)=1/4; xy2(4,2) = 1/4;
                    xy2(5,1)=3/4; xy2(6,2) = 1/4;
                    xy2(6,1)=1/2; xy2(6,2) = 1/2;
                    % Elem 3
                    xy3(1,1)=0;   xy3(1,2) = 1/2;
                    xy3(2,1)=1/4; xy3(2,2) = 1/2;
                    xy3(3,1)=1/2; xy3(3,2) = 1/2;
                    xy3(4,1)=0;   xy3(4,2) = 3/4;
                    xy3(5,1)=1/4; xy3(6,2) = 3/4;
                    xy3(6,1)=0;   xy3(6,2) = 1;
                end
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=Basis(xy3(i,:),p);
                    yolo4(:,i)=0;
                end
            case 3
                if s(1)==0
                    % Elem 1
                    xy1(1,1)=0/6; xy1(1,2) = 0;
                    xy1(2,1)=1/6; xy1(2,2) = 0;
                    xy1(3,1)=2/6; xy1(3,2) = 0;
                    xy1(4,1)=3/6; xy1(4,2) = 0;
                    xy1(5,1)=0/6; xy1(5,2) = 1/6;
                    xy1(6,1)=1/6; xy1(6,2) = 1/6;
                    xy1(7,1)=2/6; xy1(7,2) = 1/6;
                    xy1(8,1)=0/6; xy1(8,2) = 2/6;
                    xy1(9,1)=1/6; xy1(9,2) = 2/6;
                    xy1(10,1)=0/6;xy1(10,2) = 3/6;
                    % Elem 2
                    xy2(1,1)=3/6; xy2(1,2) = 0;
                    xy2(2,1)=4/6; xy2(2,2) = 0;
                    xy2(3,1)=5/6; xy2(3,2) = 0;
                    xy2(4,1)=6/6; xy2(4,2) = 0;
                    xy2(5,1)=2/6; xy2(5,2) = 1/6;
                    xy2(6,1)=3/6; xy2(6,2) = 1/6;
                    xy2(7,1)=4/6; xy2(7,2) = 1/6;
                    xy2(8,1)=1/6; xy2(8,2) = 2/6;
                    xy2(9,1)=2/6; xy2(9,2) = 2/6;
                    xy2(10,1)=0/6;xy2(10,2) = 3/6;
                    % Elem 3
                    xy3(1,1)=0/6; xy3(1,2) = 3/6;
                    xy3(2,1)=2/6; xy3(2,2) = 2/6;
                    xy3(3,1)=4/6; xy3(3,2) = 1/6;
                    xy3(4,1)=6/6; xy3(4,2) = 0/6;
                    xy3(5,1)=0/6; xy3(5,2) = 4/6;
                    xy3(6,1)=2/6; xy3(6,2) = 3/6;
                    xy3(7,1)=4/6; xy3(7,2) = 2/6;
                    xy3(8,1)=0/6; xy3(8,2) = 5/6;
                    xy3(9,1)=2/6; xy3(9,2) = 4/6;
                    xy3(10,1)=0/6;xy3(10,2) = 6/6;
                elseif s(2) ==0
                    % Elem 1
                    xy1(1,1)=0/6; xy1(1,2) = 0;
                    xy1(2,1)=1/6; xy1(2,2) = 1/6;
                    xy1(3,1)=2/6; xy1(3,2) = 2/6;
                    xy1(4,1)=3/6; xy1(4,2) = 3/6;
                    xy1(5,1)=0/6; xy1(5,2) = 2/6;
                    xy1(6,1)=1/6; xy1(6,2) = 3/6;
                    xy1(7,1)=2/6; xy1(7,2) = 4/6;
                    xy1(8,1)=0/6; xy1(8,2) = 4/6;
                    xy1(9,1)=1/6; xy1(9,2) = 5/6;
                    xy1(10,1)=0/6;xy1(10,2) = 6/6;
                    % Elem 2
                    xy2(1,1)=0/6; xy2(1,2) = 0;
                    xy2(2,1)=1/6; xy2(2,2) = 0;
                    xy2(3,1)=2/6; xy2(3,2) = 0;
                    xy2(4,1)=3/6; xy2(4,2) = 0;
                    xy2(5,1)=1/6; xy2(5,2) = 1/6;
                    xy2(6,1)=2/6; xy2(6,2) = 1/6;
                    xy2(7,1)=3/6; xy2(7,2) = 1/6;
                    xy2(8,1)=2/6; xy2(8,2) = 2/6;
                    xy2(9,1)=3/6; xy2(9,2) = 2/6;
                    xy2(10,1)=3/6;xy2(10,2) = 3/6;
                    % Elem 3
                    xy3(1,1)=3/6; xy3(1,2) = 0/6;
                    xy3(2,1)=4/6; xy3(2,2) = 0/6;
                    xy3(3,1)=5/6; xy3(3,2) = 0/6;
                    xy3(4,1)=6/6; xy3(4,2) = 0/6;
                    xy3(5,1)=3/6; xy3(5,2) = 1/6;
                    xy3(6,1)=4/6; xy3(6,2) = 1/6;
                    xy3(7,1)=5/6; xy3(7,2) = 1/6;
                    xy3(8,1)=3/6; xy3(8,2) = 2/6;
                    xy3(9,1)=4/6; xy3(9,2) = 2/6;
                    xy3(10,1)=3/6;xy3(10,2) = 3/6;
                elseif s(3) ==0
                    % Elem 1
                    xy1(1,1)=0/6; xy1(1,2) = 0;
                    xy1(2,1)=1/6; xy1(2,2) = 1/6;
                    xy1(3,1)=2/6; xy1(3,2) = 2/6;
                    xy1(4,1)=3/6; xy1(4,2) = 3/6;
                    xy1(5,1)=0/6; xy1(5,2) = 1/6;
                    xy1(6,1)=1/6; xy1(6,2) = 2/6;
                    xy1(7,1)=2/6; xy1(7,2) = 3/6;
                    xy1(8,1)=0/6; xy1(8,2) = 2/6;
                    xy1(9,1)=1/6; xy1(9,2) = 3/6;
                    xy1(10,1)=0/6;xy1(10,2) = 3/6;
                    % Elem 2
                    xy2(1,1)=0/6; xy2(1,2) = 0;
                    xy2(2,1)=2/6; xy2(2,2) = 0;
                    xy2(3,1)=4/6; xy2(3,2) = 0;
                    xy2(4,1)=6/6; xy2(4,2) = 0;
                    xy2(5,1)=1/6; xy2(5,2) = 1/6;
                    xy2(6,1)=3/6; xy2(6,2) = 1/6;
                    xy2(7,1)=5/6; xy2(7,2) = 1/6;
                    xy2(8,1)=2/6; xy2(8,2) = 2/6;
                    xy2(9,1)=4/6; xy2(9,2) = 2/6;
                    xy2(10,1)=3/6;xy2(10,2) = 3/6;
                    % Elem 3
                    xy3(1,1)=0/6; xy3(1,2) = 3/6;
                    xy3(2,1)=1/6; xy3(2,2) = 3/6;
                    xy3(3,1)=2/6; xy3(3,2) = 3/6;
                    xy3(4,1)=3/6; xy3(4,2) = 3/6;
                    xy3(5,1)=0/6; xy3(5,2) = 4/6;
                    xy3(6,1)=1/6; xy3(6,2) = 4/6;
                    xy3(7,1)=2/6; xy3(7,2) = 4/6;
                    xy3(8,1)=0/6; xy3(8,2) = 5/6;
                    xy3(9,1)=1/6; xy3(9,2) = 5/6;
                    xy3(10,1)=0/6;xy3(10,2) = 6/6;
                end
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=Basis(xy3(i,:),p);
                    yolo4(:,i)=0;
                end
        end
        
    case 3
        switch p
            case 0
                for i=1:rank
                    yolo1(:,i)=1;
                    yolo2(:,i)=1;
                    yolo3(:,i)=1;
                    yolo4(:,i)=1;
                end
            case 1
                % Elem 1
                    xy1(1,1)=0;   xy1(1,2) = 0;
                    xy1(2,1)=1/2; xy1(2,2) = 0;
                    xy1(3,1)=0;   xy1(3,2) = 1/2;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 1/2;
                    xy2(2,1)=1/2;   xy2(2,2) = 0;
                    xy2(3,1)=1/2;   xy2(3,2) = 1/2;
                    % Elem 3
                    xy3(1,1)=1/2; xy3(1,2) = 0;
                    xy3(2,1)=1; xy3(2,2) = 0;
                    xy3(3,1)=1/2; xy3(3,2) = 1/2;
                    % Elem 4
                    xy4(1,1)=0; xy4(1,2) = 1/2;
                    xy4(2,1)=1/2; xy4(2,2) = 1/2;
                    xy4(3,1)=0; xy4(3,2) = 1;
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=Basis(xy3(i,:),p);
                    yolo4(:,i)=Basis(xy4(i,:),p);
                end
            case 2
                % Elem 1
                    xy1(1,1)=0; xy1(1,2) = 0;
                    xy1(2,1)=1/4; xy1(2,2) = 0;
                    xy1(3,1)=1/2; xy1(3,2) = 0;
                    xy1(4,1)=0; xy1(4,2) = 1/4;
                    xy1(5,1)=1/4; xy1(5,2) = 1/4;
                    xy1(6,1)=0; xy1(6,2) = 1/2;
                    % Elem 2
                    xy2(1,1)=0; xy2(1,2) = 1/2;
                    xy2(2,1)=1/4; xy2(2,2) = 1/4;
                    xy2(3,1)=1/2; xy2(3,2) = 0;
                    xy2(4,1)=1/4; xy2(4,2) = 1/2;
                    xy2(5,1)=1/2; xy2(6,2) = 1/4;
                    xy2(6,1)=1/2; xy2(6,2) = 1/2;
                    % Elem 3
                    xy3(1,1)=1/2;   xy3(1,2) = 0;
                    xy3(2,1)=3/4; xy3(2,2) = 0;
                    xy3(3,1)=2/2; xy3(3,2) = 0;
                    xy3(4,1)=1/2;   xy3(4,2) = 1/4;
                    xy3(5,1)=3/4; xy3(6,2) = 1/4;
                    xy3(6,1)=1/2;   xy3(6,2) = 1/2;
                    % Elem 4
                    xy4(1,1)=0;   xy4(1,2) = 1/2;
                    xy4(2,1)=1/4; xy4(2,2) = 1/2;
                    xy4(3,1)=1/2; xy4(3,2) = 1/2;
                    xy4(4,1)=0;   xy4(4,2) = 3/4;
                    xy4(5,1)=1/4; xy4(6,2) = 3/4;
                    xy4(6,1)=0;   xy4(6,2) = 1;
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=Basis(xy3(i,:),p);
                    yolo4(:,i)=Basis(xy4(i,:),p);
                end
            case 3
                % Elem 1
                    xy1(1,1)=0/6; xy1(1,2) = 0;
                    xy1(2,1)=1/6; xy1(2,2) = 0/6;
                    xy1(3,1)=2/6; xy1(3,2) = 0/6;
                    xy1(4,1)=3/6; xy1(4,2) = 0/6;
                    xy1(5,1)=0/6; xy1(5,2) = 1/6;
                    xy1(6,1)=1/6; xy1(6,2) = 1/6;
                    xy1(7,1)=2/6; xy1(7,2) = 1/6;
                    xy1(8,1)=0/6; xy1(8,2) = 2/6;
                    xy1(9,1)=1/6; xy1(9,2) = 1/6;
                    xy1(10,1)=0/6;xy1(10,2) = 3/6;
                    % Elem 2
                    xy2(1,1)=0/6; xy2(1,2) = 3/6;
                    xy2(2,1)=1/6; xy2(2,2) = 2/6;
                    xy2(3,1)=2/6; xy2(3,2) = 1/6;
                    xy2(4,1)=3/6; xy2(4,2) = 0;
                    xy2(5,1)=1/6; xy2(5,2) = 3/6;
                    xy2(6,1)=2/6; xy2(6,2) = 2/6;
                    xy2(7,1)=3/6; xy2(7,2) = 1/6;
                    xy2(8,1)=1/6; xy2(8,2) = 3/6;
                    xy2(9,1)=2/6; xy2(9,2) = 2/6;
                    xy2(10,1)=3/6;xy2(10,2) = 3/6;
                    % Elem 3
                    xy3(1,1)=3/6; xy3(1,2) = 0/6;
                    xy3(2,1)=4/6; xy3(2,2) = 0/6;
                    xy3(3,1)=5/6; xy3(3,2) = 0/6;
                    xy3(4,1)=6/6; xy3(4,2) = 0/6;
                    xy3(5,1)=3/6; xy3(5,2) = 1/6;
                    xy3(6,1)=4/6; xy3(6,2) = 1/6;
                    xy3(7,1)=5/6; xy3(7,2) = 1/6;
                    xy3(8,1)=3/6; xy3(8,2) = 2/6;
                    xy3(9,1)=4/6; xy3(9,2) = 2/6;
                    xy3(10,1)=3/6;xy3(10,2) = 3/6;
                    % Elem 4
                    xy4(1,1)=0/6; xy4(1,2) = 3/6;
                    xy4(2,1)=1/6; xy4(2,2) = 3/6;
                    xy4(3,1)=2/6; xy4(3,2) = 3/6;
                    xy4(4,1)=3/6; xy4(4,2) = 3/6;
                    xy4(5,1)=0/6; xy4(5,2) = 4/6;
                    xy4(6,1)=1/6; xy4(6,2) = 4/6;
                    xy4(7,1)=2/6; xy4(7,2) = 4/6;
                    xy4(8,1)=0/6; xy4(8,2) = 5/6;
                    xy4(9,1)=1/6; xy4(9,2) = 5/6;
                    xy4(10,1)=0/6;xy4(10,2) = 6/6;
                for i=1:rank
                    yolo1(:,i)=Basis(xy1(i,:),p);
                    yolo2(:,i)=Basis(xy2(i,:),p);
                    yolo3(:,i)=Basis(xy3(i,:),p);
                    yolo4(:,i)=Basis(xy4(i,:),p);
                end
        end
    otherwise
        cout << "Invalid Order \n"; 
end

yolo1 = transpose(yolo1);
yolo2 = transpose(yolo2);
yolo3 = transpose(yolo3);
yolo4 = transpose(yolo4);

U_elem1 = yolo1*U_basis;
U_elem2 = yolo2*U_basis;
U_elem3 = yolo3*U_basis;
U_elem4 = yolo4*U_basis;
end
